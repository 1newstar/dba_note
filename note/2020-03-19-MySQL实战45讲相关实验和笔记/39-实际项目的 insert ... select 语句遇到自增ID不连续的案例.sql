

1. 默认的表结构和自增ID
2. insert into select 插入2行记录
3. 此时的表结构和自增ID
4. 再插入一行记录进行观察
5. 小结
6. 相关参考


1. 默认的表结构和自增ID
	mysql> show create table table_aaaaaa_bbbbbb_log;
	+-------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
	| Table                   | Create Table                                                                                                                                                                                                                                                                                                                                                                                                                                              |
	+-------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
	| table_aaaaaa_bbbbbb_log | CREATE TABLE `table_aaaaaa_bbbbbb_log` (
	  `ID` int(10) unsigned NOT NULL AUTO_INCREMENT COMMENT '??',
	  `nClubID` int(11) NOT NULL COMMENT '???ID',
	  `nPlayerID` int(11) NOT NULL COMMENT '??ID',
	  `CreateTime` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '????',
	  `szRemark` varchar(256) NOT NULL DEFAULT '' COMMENT '??',
	  PRIMARY KEY (`ID`)
	) ENGINE=InnoDB AUTO_INCREMENT=67 DEFAULT CHARSET=utf8mb4 COMMENT='????????????????????' |
	+-------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
	1 row in set (0.01 sec)
	
	下一行记录的自增ID从67开始


2. insert into select 插入2行记录

	insert into table_aaaaaa_bbbbbb_log(nClubID, nPlayerID, CreateTime, szRemark) 
	select 10,10,NOW(),concat('bin_test_user02',"(ID:",10,")"," 赠送乐卡给 ",tu.szNickName,"(ID:",tl.nPlayerID,") ",20,"张" ) from table_league_club_member tl  inner join table_user tu on tl.nPlayerID=tu.nPlayerID
	where tl.nPlayerID in (5,10) AND tl.nClubID = 10;


	mysql> select 10,10,NOW(),concat('bin_test_user02',"(ID:",10,")"," 赠送乐卡给 ",tu.szNickName,"(ID:",tl.nPlayerID,") ",20,"张" ) from table_league_club_member tl  inner join table_user tu on tl.nPlayerID=t 
		-> where tl.nPlayerID in (5,10) AND tl.nClubID = 10;
	+----+----+---------------------+--------------------------------------------------------------------------------------------------------------+
	| 10 | 10 | NOW()               | concat('bin_test_user02',"(ID:",10,")"," 赠送乐卡给 ",tu.szNickName,"(ID:",tl.nPlayerID,") ",20,"张" ) |
	+----+----+---------------------+--------------------------------------------------------------------------------------------------------------+
	| 10 | 10 | 2020-11-16 16:19:08 | bin_test_user02(ID:10) 赠送乐卡给 bin_test_user02(ID:10) 20张                                          |
	| 10 | 10 | 2020-11-16 16:19:08 | bin_test_user02(ID:10) 赠送乐卡给 (ID:5) 20张                                                          |
	+----+----+---------------------+--------------------------------------------------------------------------------------------------------------+
	2 rows in set (0.00 sec)

	mysql> insert into table_aaaaaa_bbbbbb_log(nClubID, nPlayerID, CreateTime, szRemark) 
		-> select 10,10,NOW(),concat('bin_test_user02',"(ID:",10,")"," 赠送乐卡给 ",tu.szNickName,"(ID:",tl.nPlayerID,") ",20,"张" ) from table_league_club_member tl  inner join table_user tu on tl.nPlayerID=tu.nPlayerID
	Query OK, 2 rows affected (0.00 sec)
	Records: 2  Duplicates: 0  Warnings: 0

	root@mysqldb 17:07:  [aiuaiuh5_db]> select * from table_aaaaaa_bbbbbb_log order by ID desc limit 2;
	+----+---------+-----------+---------------------+---------------------------------------------------------+
	| ID | nClubID | nPlayerID | CreateTime          | szRemark                                                |
	+----+---------+-----------+---------------------+---------------------------------------------------------+
	| 68 |      10 |        10 | 2020-11-16 17:07:35 | bin_test_user02(ID:10) ????? (ID:5) 20?                 |
	| 67 |      10 |        10 | 2020-11-16 17:07:35 | bin_test_user02(ID:10) ????? bin_test_user02(ID:10) 20? |
	+----+---------+-----------+---------------------+---------------------------------------------------------+
	2 rows in set (0.00 sec)
	

3. 此时的表结构和自增ID
	mysql> show create table table_aaaaaa_bbbbbb_log;
	+-------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
	| Table                   | Create Table                                                                                                                                                                                                                                                                                                                                                                                                                                              |
	+-------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
	| table_aaaaaa_bbbbbb_log | CREATE TABLE `table_aaaaaa_bbbbbb_log` (
	  `ID` int(10) unsigned NOT NULL AUTO_INCREMENT COMMENT '??',
	  `nClubID` int(11) NOT NULL COMMENT '???ID',
	  `nPlayerID` int(11) NOT NULL COMMENT '??ID',
	  `CreateTime` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '????',
	  `szRemark` varchar(256) NOT NULL DEFAULT '' COMMENT '??',
	  PRIMARY KEY (`ID`)
	) ENGINE=InnoDB AUTO_INCREMENT=70 DEFAULT CHARSET=utf8mb4 COMMENT='????????????????????' |
	+-------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
	1 row in set (0.00 sec)
	
	申请了67-69这3个自增ID
	下一行记录的自增ID从70开始	

4. 再插入一行记录进行观察
	
	INSERT INTO `aiuaiuh5_db`.`table_aaaaaa_bbbbbb_log` ( `nClubID`, `nPlayerID`, `CreateTime`, `szRemark`) VALUES ('10', '10', '2020-11-16 17:04:19', 'bin_test_user02(ID:10) 赠送乐卡给 (ID:5) 20张');

	mysql> select * from table_aaaaaa_bbbbbb_log order by ID desc limit 1;
	+----+---------+-----------+---------------------+-----------------------------------------+
	| ID | nClubID | nPlayerID | CreateTime          | szRemark                                |
	+----+---------+-----------+---------------------+-----------------------------------------+
	| 70 |      10 |        10 | 2020-11-16 17:04:19 | bin_test_user02(ID:10) ????? (ID:5) 20? |
	+----+---------+-----------+---------------------+-----------------------------------------+
	1 row in set (0.00 sec)


	mysql> show create table table_aaaaaa_bbbbbb_log;
	+-------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
	| Table                   | Create Table                                                                                                                                                                                                                                                                                                                                                                                                                                              |
	+-------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
	| table_aaaaaa_bbbbbb_log | CREATE TABLE `table_aaaaaa_bbbbbb_log` (
	  `ID` int(10) unsigned NOT NULL AUTO_INCREMENT COMMENT '??',
	  `nClubID` int(11) NOT NULL COMMENT '???ID',
	  `nPlayerID` int(11) NOT NULL COMMENT '??ID',
	  `CreateTime` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '????',
	  `szRemark` varchar(256) NOT NULL DEFAULT '' COMMENT '??',
	  PRIMARY KEY (`ID`)
	) ENGINE=InnoDB AUTO_INCREMENT=71 DEFAULT CHARSET=utf8mb4 COMMENT='????????????????????' |
	+-------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
	1 row in set (0.00 sec)

5. 小结
	同一个语句去申请自增 id，每次申请到的自增 id 个数都是上一次的两倍;
	这里2行记录，第一次申请ID=67, 每二次申请ID: 68-79。
	
	
6. 相关参考
	《39：自增主键连续的场景/原因》
