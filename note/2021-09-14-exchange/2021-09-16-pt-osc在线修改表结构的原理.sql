
1. 创建跟源表一样的新表
2. 在源码表上创建3个触发器：分别为插入、更新、删除操作的触发器
3. 使用 insert into select lock in share mode 语句分批迁移数据到新表中
4. 数据迁移完成，做rename表操作：把原表改为 old 表，把新表改为原表
5. 默认会把 old 表删除，drop table 操作会对数据字典加排他锁，会阻塞DML请求，直到删除表完成，才释放数据字典加排他锁。
6. 在线修改表结构完成。

-- 以上是自己的描述。


使用不当，会导致死锁。操作最后1个chunk的时候，需要持有新表的自增锁，直到最后1个chunk的数据迁移完成后，才会释放自增锁，期间会阻塞业务新插入的数据。