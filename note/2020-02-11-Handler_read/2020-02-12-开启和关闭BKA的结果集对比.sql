
BKA开启
	root@mysqldb 05:19:  [db1]> set optimizer_switch='mrr=on,mrr_cost_based=off,batched_key_access=on';
	Query OK, 0 rows affected (0.00 sec)

	root@mysqldb 05:21:  [db1]> show variables like '%switch%';
	+------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
	| Variable_name    | Value                                                                                                                                                                                                                                                                                                                                                                                                            |
	+------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
	| optimizer_switch | index_merge=on,index_merge_union=on,index_merge_sort_union=on,index_merge_intersection=on,engine_condition_pushdown=on,index_condition_pushdown=on,mrr=on,mrr_cost_based=off,block_nested_loop=on,batched_key_access=on,materialization=on,semijoin=on,loosescan=on,firstmatch=on,duplicateweedout=on,subquery_materialization_cost_based=on,use_index_extensions=on,condition_fanout_filter=on,derived_merge=on |
	+------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
	1 row in set (0.00 sec)

	root@mysqldb 05:21:  [db1]> select * from t1 STRAIGHT_JOIN t2  on t1.a=t2.a;
	+------+------+------+------+------+------+
	| id   | a    | b    | id   | a    | b    |
	+------+------+------+------+------+------+
	| 1000 |    1 | 1000 |    1 |    1 |    1 |
	|  999 |    2 |  999 |    2 |    2 |    2 |
	|  998 |    3 |  998 |    3 |    3 |    3 |
	|  997 |    4 |  997 |    4 |    4 |    4 |
	|  996 |    5 |  996 |    5 |    5 |    5 |
	|  995 |    6 |  995 |    6 |    6 |    6 |
	..........................................
	|    5 |  996 |    5 |  996 |  996 |  996 |
	|    4 |  997 |    4 |  997 |  997 |  997 |
	|    3 |  998 |    3 |  998 |  998 |  998 |
	|    2 |  999 |    2 |  999 |  999 |  999 |
	|    1 | 1000 |    1 | 1000 | 1000 | 1000 |
	+------+------+------+------+------+------+
	1000 rows in set (0.01 sec)


BKA关闭

	root@mysqldb 05:19:  [db1]> set optimizer_switch='mrr=on,mrr_cost_based=off,batched_key_access=off';
	Query OK, 0 rows affected (0.00 sec)

	root@mysqldb 05:19:  [db1]> show variables like '%switch%';
	+------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
	| Variable_name    | Value                                                                                                                                                                                                                                                                                                                                                                                                             |
	+------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
	| optimizer_switch | index_merge=on,index_merge_union=on,index_merge_sort_union=on,index_merge_intersection=on,engine_condition_pushdown=on,index_condition_pushdown=on,mrr=on,mrr_cost_based=off,block_nested_loop=on,batched_key_access=off,materialization=on,semijoin=on,loosescan=on,firstmatch=on,duplicateweedout=on,subquery_materialization_cost_based=on,use_index_extensions=on,condition_fanout_filter=on,derived_merge=on |
	+------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
	1 row in set (0.01 sec)

	root@mysqldb 05:19:  [db1]> select * from t1 STRAIGHT_JOIN t2  on t1.a=t2.a;
	+------+------+------+------+------+------+
	| id   | a    | b    | id   | a    | b    |
	+------+------+------+------+------+------+
	|    1 | 1000 |    1 | 1000 | 1000 | 1000 |
	|    2 |  999 |    2 |  999 |  999 |  999 |
	|    3 |  998 |    3 |  998 |  998 |  998 |
	|    4 |  997 |    4 |  997 |  997 |  997 |
	|    5 |  996 |    5 |  996 |  996 |  996 |

	...........................................

	|  998 |    3 |  998 |    3 |    3 |    3 |
	|  999 |    2 |  999 |    2 |    2 |    2 |
	| 1000 |    1 | 1000 |    1 |    1 |    1 |
	+------+------+------+------+------+------+
	1000 rows in set (0.02 sec)
	
	
通过对比可以看到, 开启BKA之后的结果集中, 驱动表的数据是根据主键ID递增的.


 
	